{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA A100-SXM4-40GB"
    ],
    "config": {
        "seed": 1,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.0004698022905585765,
            "weight_decay": 0.02594199434018928
        },
        "model": {
            "arch_type": "plain",
            "backbone": {
                "type": "MLP",
                "n_blocks": 2,
                "d_block": 880,
                "dropout": 0.48126530671313694
            },
            "num_embeddings": {
                "type": "PeriodicEmbeddings",
                "n_frequencies": 24,
                "d_embedding": 28,
                "frequency_init_scale": 0.012273037086848489,
                "lite": true
            }
        }
    },
    "n_parameters": 3079213,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 2652,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.9737732656514383,
                "recall": 0.9319838056680162,
                "f1-score": 0.9524203558129913,
                "support": 1235.0
            },
            "1": {
                "precision": 0.8895625408077604,
                "recall": 0.9243070362473348,
                "f1-score": 0.9066020248110651,
                "support": 10318.0
            },
            "2": {
                "precision": 0.8180389074474357,
                "recall": 0.8127684498242874,
                "f1-score": 0.8153951620801096,
                "support": 5122.0
            },
            "3": {
                "precision": 0.9523809523809523,
                "recall": 0.8013937282229965,
                "f1-score": 0.8703878902554399,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9880613985218875,
                "recall": 0.9914432401597262,
                "f1-score": 0.989749430523918,
                "support": 1753.0
            },
            "5": {
                "precision": 0.992172858560247,
                "recall": 0.9949148795047534,
                "f1-score": 0.9935419771485345,
                "support": 9046.0
            },
            "6": {
                "precision": 0.9719358533791523,
                "recall": 0.933957072096863,
                "f1-score": 0.9525680606230704,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9863468634686346,
                "recall": 0.9868931142698911,
                "f1-score": 0.9866199132601274,
                "support": 5417.0
            },
            "8": {
                "precision": 0.9775600505689002,
                "recall": 0.9754020813623463,
                "f1-score": 0.9764798737174428,
                "support": 3171.0
            },
            "accuracy": 0.9369712886038232,
            "macro avg": {
                "precision": 0.9499814100873787,
                "recall": 0.9281181563729128,
                "f1-score": 0.9381960764702999,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.9375336531546711,
                "recall": 0.9369712886038232,
                "f1-score": 0.9368497308516986,
                "support": 39601.0
            },
            "cross-entropy": 0.17384253575052794,
            "score": 0.9369712886038232
        },
        "val": {
            "0": {
                "precision": 0.6877637130801688,
                "recall": 0.5292207792207793,
                "f1-score": 0.5981651376146789,
                "support": 308.0
            },
            "1": {
                "precision": 0.7680262199563,
                "recall": 0.8174418604651162,
                "f1-score": 0.7919639504318438,
                "support": 2580.0
            },
            "2": {
                "precision": 0.603273577552611,
                "recall": 0.6042154566744731,
                "f1-score": 0.6037441497659906,
                "support": 1281.0
            },
            "3": {
                "precision": 0.7571884984025559,
                "recall": 0.5498839907192575,
                "f1-score": 0.6370967741935483,
                "support": 431.0
            },
            "4": {
                "precision": 0.9612756264236902,
                "recall": 0.9634703196347032,
                "f1-score": 0.9623717217787914,
                "support": 438.0
            },
            "5": {
                "precision": 0.9454061251664447,
                "recall": 0.9416445623342176,
                "f1-score": 0.9435215946843855,
                "support": 2262.0
            },
            "6": {
                "precision": 0.7350230414746544,
                "recall": 0.7026431718061674,
                "f1-score": 0.7184684684684685,
                "support": 454.0
            },
            "7": {
                "precision": 0.9156363636363636,
                "recall": 0.9298375184638109,
                "f1-score": 0.9226823012092341,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8501827040194885,
                "recall": 0.880201765447667,
                "f1-score": 0.8649318463444857,
                "support": 793.0
            },
            "accuracy": 0.8192101807898192,
            "macro avg": {
                "precision": 0.802641763301364,
                "recall": 0.7687288249740214,
                "f1-score": 0.7825495493879362,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8180683696346834,
                "recall": 0.8192101807898192,
                "f1-score": 0.817355717201847,
                "support": 9901.0
            },
            "cross-entropy": 0.5745414334206529,
            "score": 0.8192101807898192
        },
        "test": {
            "0": {
                "precision": 0.6936026936026936,
                "recall": 0.533678756476684,
                "f1-score": 0.6032210834553441,
                "support": 386.0
            },
            "1": {
                "precision": 0.7754922127534528,
                "recall": 0.8185483870967742,
                "f1-score": 0.7964388109250039,
                "support": 3224.0
            },
            "2": {
                "precision": 0.5975687779910429,
                "recall": 0.5833853841349157,
                "f1-score": 0.5903919089759797,
                "support": 1601.0
            },
            "3": {
                "precision": 0.723404255319149,
                "recall": 0.5687732342007435,
                "f1-score": 0.6368366285119668,
                "support": 538.0
            },
            "4": {
                "precision": 0.9709618874773139,
                "recall": 0.9762773722627737,
                "f1-score": 0.9736123748862602,
                "support": 548.0
            },
            "5": {
                "precision": 0.9417543859649122,
                "recall": 0.9494163424124513,
                "f1-score": 0.9455698432270565,
                "support": 2827.0
            },
            "6": {
                "precision": 0.751434034416826,
                "recall": 0.6919014084507042,
                "f1-score": 0.7204399633363887,
                "support": 568.0
            },
            "7": {
                "precision": 0.9100346020761245,
                "recall": 0.9320732427643237,
                "f1-score": 0.920922089290925,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8614341085271318,
                "recall": 0.8970736629667003,
                "f1-score": 0.8788927335640138,
                "support": 991.0
            },
            "accuracy": 0.8212669683257918,
            "macro avg": {
                "precision": 0.8028541064587384,
                "recall": 0.7723475323073411,
                "f1-score": 0.785147270685882,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8184734740180618,
                "recall": 0.8212669683257918,
                "f1-score": 0.818873371088644,
                "support": 12376.0
            },
            "cross-entropy": 0.5560648235870692,
            "score": 0.8212669683257918
        }
    },
    "time": "0:00:31.044978",
    "chunk_size": null,
    "eval_batch_size": 32768
}