{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA A100-SXM4-40GB"
    ],
    "config": {
        "seed": 4,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.0004698022905585765,
            "weight_decay": 0.02594199434018928
        },
        "model": {
            "arch_type": "plain",
            "backbone": {
                "type": "MLP",
                "n_blocks": 2,
                "d_block": 880,
                "dropout": 0.48126530671313694
            },
            "num_embeddings": {
                "type": "PeriodicEmbeddings",
                "n_frequencies": 24,
                "d_embedding": 28,
                "frequency_init_scale": 0.012273037086848489,
                "lite": true
            }
        }
    },
    "n_parameters": 3079213,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 2106,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.9529914529914529,
                "recall": 0.902834008097166,
                "f1-score": 0.9272349272349272,
                "support": 1235.0
            },
            "1": {
                "precision": 0.8594351732991015,
                "recall": 0.9084124830393487,
                "f1-score": 0.8832453825857521,
                "support": 10318.0
            },
            "2": {
                "precision": 0.7885215221459763,
                "recall": 0.740335806325654,
                "f1-score": 0.7636693182962441,
                "support": 5122.0
            },
            "3": {
                "precision": 0.8802049967969251,
                "recall": 0.7979094076655052,
                "f1-score": 0.8370392933292721,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9863636363636363,
                "recall": 0.9903023388476897,
                "f1-score": 0.9883290634785085,
                "support": 1753.0
            },
            "5": {
                "precision": 0.9885133642588911,
                "recall": 0.9893875746186159,
                "f1-score": 0.988950276243094,
                "support": 9046.0
            },
            "6": {
                "precision": 0.9243093922651934,
                "recall": 0.9207484865162355,
                "f1-score": 0.9225255031706644,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9840534025588726,
                "recall": 0.9796935573195495,
                "f1-score": 0.9818686401480111,
                "support": 5417.0
            },
            "8": {
                "precision": 0.9745060548119822,
                "recall": 0.9643645537685273,
                "f1-score": 0.969408781106356,
                "support": 3171.0
            },
            "accuracy": 0.9186131663341834,
            "macro avg": {
                "precision": 0.9265443328324481,
                "recall": 0.9104431351331436,
                "f1-score": 0.9180301317325367,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.9184250473045634,
                "recall": 0.9186131663341834,
                "f1-score": 0.9181320789648058,
                "support": 39601.0
            },
            "cross-entropy": 0.2210382340446783,
            "score": 0.9186131663341834
        },
        "val": {
            "0": {
                "precision": 0.7058823529411765,
                "recall": 0.5454545454545454,
                "f1-score": 0.6153846153846153,
                "support": 308.0
            },
            "1": {
                "precision": 0.763271162123386,
                "recall": 0.8248062015503876,
                "f1-score": 0.7928464977645305,
                "support": 2580.0
            },
            "2": {
                "precision": 0.632213608957795,
                "recall": 0.5729898516783762,
                "f1-score": 0.6011466011466011,
                "support": 1281.0
            },
            "3": {
                "precision": 0.6843501326259946,
                "recall": 0.5986078886310905,
                "f1-score": 0.6386138613861386,
                "support": 431.0
            },
            "4": {
                "precision": 0.9655963302752294,
                "recall": 0.9611872146118722,
                "f1-score": 0.9633867276887872,
                "support": 438.0
            },
            "5": {
                "precision": 0.9472743521000894,
                "recall": 0.9372236958443855,
                "f1-score": 0.9422222222222222,
                "support": 2262.0
            },
            "6": {
                "precision": 0.6975806451612904,
                "recall": 0.762114537444934,
                "f1-score": 0.728421052631579,
                "support": 454.0
            },
            "7": {
                "precision": 0.9212076583210603,
                "recall": 0.9239290989660266,
                "f1-score": 0.922566371681416,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8603213844252163,
                "recall": 0.8776796973518285,
                "f1-score": 0.8689138576779026,
                "support": 793.0
            },
            "accuracy": 0.8203211796788203,
            "macro avg": {
                "precision": 0.7975219585479153,
                "recall": 0.7782214146148274,
                "f1-score": 0.7859446452870881,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8184415029240529,
                "recall": 0.8203211796788203,
                "f1-score": 0.8183588085831208,
                "support": 9901.0
            },
            "cross-entropy": 0.5238657435407069,
            "score": 0.8203211796788203
        },
        "test": {
            "0": {
                "precision": 0.6966666666666667,
                "recall": 0.5414507772020726,
                "f1-score": 0.60932944606414,
                "support": 386.0
            },
            "1": {
                "precision": 0.7766647024160283,
                "recall": 0.8176178660049628,
                "f1-score": 0.7966152916288909,
                "support": 3224.0
            },
            "2": {
                "precision": 0.6106612685560054,
                "recall": 0.5652717051842598,
                "f1-score": 0.587090496269867,
                "support": 1601.0
            },
            "3": {
                "precision": 0.6555772994129159,
                "recall": 0.6226765799256505,
                "f1-score": 0.6387035271687322,
                "support": 538.0
            },
            "4": {
                "precision": 0.9742647058823529,
                "recall": 0.9671532846715328,
                "f1-score": 0.9706959706959707,
                "support": 548.0
            },
            "5": {
                "precision": 0.944739638682253,
                "recall": 0.9434029006013441,
                "f1-score": 0.944070796460177,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7099494097807757,
                "recall": 0.7411971830985915,
                "f1-score": 0.7252368647717484,
                "support": 568.0
            },
            "7": {
                "precision": 0.9188712522045855,
                "recall": 0.9232132309509746,
                "f1-score": 0.9210371243370653,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8540856031128404,
                "recall": 0.8859737638748738,
                "f1-score": 0.8697374938088163,
                "support": 991.0
            },
            "accuracy": 0.8196509372979961,
            "macro avg": {
                "precision": 0.7934978385238248,
                "recall": 0.7786619212793624,
                "f1-score": 0.7847241123561565,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8171642499002788,
                "recall": 0.8196509372979961,
                "f1-score": 0.8177951704208944,
                "support": 12376.0
            },
            "cross-entropy": 0.5168151940382025,
            "score": 0.8196509372979961
        }
    },
    "time": "0:00:26.489164",
    "chunk_size": null,
    "eval_batch_size": 32768
}