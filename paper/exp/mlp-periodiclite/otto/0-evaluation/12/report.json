{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA A100-SXM4-40GB"
    ],
    "config": {
        "seed": 12,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.0004698022905585765,
            "weight_decay": 0.02594199434018928
        },
        "model": {
            "arch_type": "plain",
            "backbone": {
                "type": "MLP",
                "n_blocks": 2,
                "d_block": 880,
                "dropout": 0.48126530671313694
            },
            "num_embeddings": {
                "type": "PeriodicEmbeddings",
                "n_frequencies": 24,
                "d_embedding": 28,
                "frequency_init_scale": 0.012273037086848489,
                "lite": true
            }
        }
    },
    "n_parameters": 3079213,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 2028,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.9355648535564853,
                "recall": 0.9052631578947369,
                "f1-score": 0.9201646090534978,
                "support": 1235.0
            },
            "1": {
                "precision": 0.8458687398300488,
                "recall": 0.9068617949214964,
                "f1-score": 0.8753040224508886,
                "support": 10318.0
            },
            "2": {
                "precision": 0.7709590180986062,
                "recall": 0.723545490042952,
                "f1-score": 0.7465001510726157,
                "support": 5122.0
            },
            "3": {
                "precision": 0.9066951566951567,
                "recall": 0.7392566782810686,
                "f1-score": 0.8144593730006399,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9830220713073005,
                "recall": 0.9908727895037079,
                "f1-score": 0.9869318181818182,
                "support": 1753.0
            },
            "5": {
                "precision": 0.986544612330429,
                "recall": 0.9888348441300022,
                "f1-score": 0.9876884005962568,
                "support": 9046.0
            },
            "6": {
                "precision": 0.9417195614541258,
                "recall": 0.8981838194826637,
                "f1-score": 0.9194366197183099,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9814849102018145,
                "recall": 0.9785859331733432,
                "f1-score": 0.9800332778702163,
                "support": 5417.0
            },
            "8": {
                "precision": 0.9671406003159557,
                "recall": 0.9653106275622831,
                "f1-score": 0.9662247474747474,
                "support": 3171.0
            },
            "accuracy": 0.9123506982146915,
            "macro avg": {
                "precision": 0.9243332804211026,
                "recall": 0.8996350149991392,
                "f1-score": 0.9107492243798878,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.9124872781421897,
                "recall": 0.9123506982146915,
                "f1-score": 0.9116421059440518,
                "support": 39601.0
            },
            "cross-entropy": 0.2277940884227352,
            "score": 0.9123506982146915
        },
        "val": {
            "0": {
                "precision": 0.6809338521400778,
                "recall": 0.5681818181818182,
                "f1-score": 0.6194690265486726,
                "support": 308.0
            },
            "1": {
                "precision": 0.7582804792107117,
                "recall": 0.834108527131783,
                "f1-score": 0.7943890734588408,
                "support": 2580.0
            },
            "2": {
                "precision": 0.6119273984442524,
                "recall": 0.5526932084309133,
                "f1-score": 0.5808039376538146,
                "support": 1281.0
            },
            "3": {
                "precision": 0.7029411764705882,
                "recall": 0.5545243619489559,
                "f1-score": 0.6199740596627756,
                "support": 431.0
            },
            "4": {
                "precision": 0.9658314350797267,
                "recall": 0.9680365296803652,
                "f1-score": 0.9669327251995438,
                "support": 438.0
            },
            "5": {
                "precision": 0.9520179372197309,
                "recall": 0.9385499557913352,
                "f1-score": 0.9452359750667854,
                "support": 2262.0
            },
            "6": {
                "precision": 0.75,
                "recall": 0.7334801762114538,
                "f1-score": 0.7416481069042318,
                "support": 454.0
            },
            "7": {
                "precision": 0.9165467625899281,
                "recall": 0.9409158050221565,
                "f1-score": 0.9285714285714286,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8635235732009926,
                "recall": 0.8776796973518285,
                "f1-score": 0.8705440900562852,
                "support": 793.0
            },
            "accuracy": 0.8205231794768205,
            "macro avg": {
                "precision": 0.8002225127062231,
                "recall": 0.7742411199722901,
                "f1-score": 0.7852853803469309,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8176664134875055,
                "recall": 0.8205231794768205,
                "f1-score": 0.8178481629151936,
                "support": 9901.0
            },
            "cross-entropy": 0.5254150779041273,
            "score": 0.8205231794768205
        },
        "test": {
            "0": {
                "precision": 0.6842105263157895,
                "recall": 0.538860103626943,
                "f1-score": 0.6028985507246377,
                "support": 386.0
            },
            "1": {
                "precision": 0.7629777524244152,
                "recall": 0.8297146401985112,
                "f1-score": 0.7949479940564635,
                "support": 3224.0
            },
            "2": {
                "precision": 0.6116504854368932,
                "recall": 0.5509056839475328,
                "f1-score": 0.5796910943148209,
                "support": 1601.0
            },
            "3": {
                "precision": 0.6940639269406392,
                "recall": 0.5650557620817844,
                "f1-score": 0.6229508196721312,
                "support": 538.0
            },
            "4": {
                "precision": 0.9675675675675676,
                "recall": 0.9799270072992701,
                "f1-score": 0.9737080689029919,
                "support": 548.0
            },
            "5": {
                "precision": 0.9454867256637168,
                "recall": 0.9448178280863105,
                "f1-score": 0.9451521585279546,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7314814814814815,
                "recall": 0.6954225352112676,
                "f1-score": 0.7129963898916967,
                "support": 568.0
            },
            "7": {
                "precision": 0.8970840480274442,
                "recall": 0.9267572356763142,
                "f1-score": 0.9116792562463684,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8525073746312685,
                "recall": 0.8748738647830474,
                "f1-score": 0.8635458167330677,
                "support": 991.0
            },
            "accuracy": 0.8167420814479638,
            "macro avg": {
                "precision": 0.7941144320543573,
                "recall": 0.767370517878998,
                "f1-score": 0.778618905452237,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8127668019055128,
                "recall": 0.8167420814479638,
                "f1-score": 0.8135609377006146,
                "support": 12376.0
            },
            "cross-entropy": 0.5171477522426154,
            "score": 0.8167420814479638
        }
    },
    "time": "0:00:26.063813",
    "chunk_size": null,
    "eval_batch_size": 32768
}