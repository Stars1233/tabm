{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA A100-SXM4-40GB"
    ],
    "config": {
        "seed": 2,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.0004698022905585765,
            "weight_decay": 0.02594199434018928
        },
        "model": {
            "arch_type": "plain",
            "backbone": {
                "type": "MLP",
                "n_blocks": 2,
                "d_block": 880,
                "dropout": 0.48126530671313694
            },
            "num_embeddings": {
                "type": "PeriodicEmbeddings",
                "n_frequencies": 24,
                "d_embedding": 28,
                "frequency_init_scale": 0.012273037086848489,
                "lite": true
            }
        }
    },
    "n_parameters": 3079213,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 2340,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.9619289340101523,
                "recall": 0.9206477732793522,
                "f1-score": 0.9408357467935456,
                "support": 1235.0
            },
            "1": {
                "precision": 0.8665207877461707,
                "recall": 0.9211087420042644,
                "f1-score": 0.8929813022643992,
                "support": 10318.0
            },
            "2": {
                "precision": 0.79737108190091,
                "recall": 0.7698164779383053,
                "f1-score": 0.7833515446508393,
                "support": 5122.0
            },
            "3": {
                "precision": 0.9469534050179211,
                "recall": 0.7671312427409989,
                "f1-score": 0.8476098812961181,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9869318181818182,
                "recall": 0.9908727895037079,
                "f1-score": 0.9888983774551665,
                "support": 1753.0
            },
            "5": {
                "precision": 0.9912793906612208,
                "recall": 0.9927039575502985,
                "f1-score": 0.991991162662248,
                "support": 9046.0
            },
            "6": {
                "precision": 0.9661807580174927,
                "recall": 0.9119427627958173,
                "f1-score": 0.9382785956964893,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9843462246777164,
                "recall": 0.9867085102455233,
                "f1-score": 0.9855259518760947,
                "support": 5417.0
            },
            "8": {
                "precision": 0.9768033047346679,
                "recall": 0.9694102806685588,
                "f1-score": 0.9730927508705287,
                "support": 3171.0
            },
            "accuracy": 0.9266937703593343,
            "macro avg": {
                "precision": 0.9420350783275633,
                "recall": 0.9144825040807585,
                "f1-score": 0.92695170150727,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.9273991623269509,
                "recall": 0.9266937703593343,
                "f1-score": 0.9263361623992573,
                "support": 39601.0
            },
            "cross-entropy": 0.19832600887907711,
            "score": 0.9266937703593343
        },
        "val": {
            "0": {
                "precision": 0.6521739130434783,
                "recall": 0.5844155844155844,
                "f1-score": 0.6164383561643835,
                "support": 308.0
            },
            "1": {
                "precision": 0.7597883597883598,
                "recall": 0.8348837209302326,
                "f1-score": 0.7955678670360111,
                "support": 2580.0
            },
            "2": {
                "precision": 0.616597510373444,
                "recall": 0.580015612802498,
                "f1-score": 0.5977473853580048,
                "support": 1281.0
            },
            "3": {
                "precision": 0.7508532423208191,
                "recall": 0.5104408352668214,
                "f1-score": 0.6077348066298343,
                "support": 431.0
            },
            "4": {
                "precision": 0.9723502304147466,
                "recall": 0.9634703196347032,
                "f1-score": 0.9678899082568808,
                "support": 438.0
            },
            "5": {
                "precision": 0.9496659242761692,
                "recall": 0.9425287356321839,
                "f1-score": 0.9460838695362769,
                "support": 2262.0
            },
            "6": {
                "precision": 0.7333333333333333,
                "recall": 0.7026431718061674,
                "f1-score": 0.7176602924634422,
                "support": 454.0
            },
            "7": {
                "precision": 0.9170305676855895,
                "recall": 0.930576070901034,
                "f1-score": 0.9237536656891496,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8631840796019901,
                "recall": 0.8751576292559899,
                "f1-score": 0.8691296180338134,
                "support": 793.0
            },
            "accuracy": 0.8205231794768205,
            "macro avg": {
                "precision": 0.8016641289819922,
                "recall": 0.769347964516135,
                "f1-score": 0.7824450854630886,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8188803262739489,
                "recall": 0.8205231794768205,
                "f1-score": 0.8180844085327239,
                "support": 9901.0
            },
            "cross-entropy": 0.5406081648868264,
            "score": 0.8205231794768205
        },
        "test": {
            "0": {
                "precision": 0.6697819314641744,
                "recall": 0.5569948186528497,
                "f1-score": 0.6082036775106081,
                "support": 386.0
            },
            "1": {
                "precision": 0.7660247197470538,
                "recall": 0.8266129032258065,
                "f1-score": 0.7951663434283157,
                "support": 3224.0
            },
            "2": {
                "precision": 0.597769028871391,
                "recall": 0.5690193628981887,
                "f1-score": 0.5830399999999999,
                "support": 1601.0
            },
            "3": {
                "precision": 0.7524271844660194,
                "recall": 0.5762081784386617,
                "f1-score": 0.6526315789473683,
                "support": 538.0
            },
            "4": {
                "precision": 0.9762340036563071,
                "recall": 0.9744525547445255,
                "f1-score": 0.9753424657534246,
                "support": 548.0
            },
            "5": {
                "precision": 0.948644793152639,
                "recall": 0.940926777502653,
                "f1-score": 0.9447700230864855,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7481060606060606,
                "recall": 0.6954225352112676,
                "f1-score": 0.7208029197080292,
                "support": 568.0
            },
            "7": {
                "precision": 0.9046242774566474,
                "recall": 0.9243945658594211,
                "f1-score": 0.9144025708442887,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8525703200775946,
                "recall": 0.8869828456104945,
                "f1-score": 0.8694362017804156,
                "support": 991.0
            },
            "accuracy": 0.8188429217840982,
            "macro avg": {
                "precision": 0.8017980354997652,
                "recall": 0.7723349491270963,
                "f1-score": 0.7848661978954374,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8167565415382109,
                "recall": 0.8188429217840982,
                "f1-score": 0.81669434013429,
                "support": 12376.0
            },
            "cross-entropy": 0.5325969033213465,
            "score": 0.8188429217840982
        }
    },
    "time": "0:00:30.449930",
    "chunk_size": null,
    "eval_batch_size": 32768
}